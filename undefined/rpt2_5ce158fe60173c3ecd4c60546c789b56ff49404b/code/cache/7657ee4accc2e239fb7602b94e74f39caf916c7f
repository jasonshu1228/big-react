{"code":"import { Placement } from './fiberFlags';\r\nimport { HostText } from './workTags';\r\nimport { REACT_ELEMENT_TYPE } from './../../shared/ReactSymbols';\r\nimport { FiberNode, createFiberFromElement } from './fiber';\r\n/**\r\n *\r\n * @param shouldTrackEffects 代表需不需要标记副作用\r\n * @returns 生成子节点，并标记副作用\r\n */\r\nfunction ChildReconciler(shouldTrackEffects) {\r\n    // reconcilerSingleElement 根据元素的类型和属性创建一个新的fiber节点，并将其链接到当前fiber树上\r\n    function reconcilerSingleElement(returnFiber, currentFiber, element) {\r\n        // 根据element创建fiber，再返回\r\n        const fiber = createFiberFromElement(element);\r\n        fiber.return = returnFiber;\r\n        return fiber;\r\n    }\r\n    function reconcilerSingleTextNode(returnFiber, currentFiber, content) {\r\n        const fiber = new FiberNode(HostText, { content }, null);\r\n        fiber.return = returnFiber;\r\n        return fiber;\r\n    }\r\n    // 插入单一节点并判断什么时候追踪副作用\r\n    function placeSingChild(fiber) {\r\n        // 刚创建的fiber 应该是正在工作的 fiber 单元，所以 fiber 是 workInProgress\r\n        // workInProgress.alternate 也就是 current fiber\r\n        if (shouldTrackEffects && fiber.alternate === null) {\r\n            // current fiber 是 null 的话也就是 首屏渲染\r\n            // 按位或运算\r\n            fiber.flags |= Placement;\r\n        }\r\n        return fiber;\r\n    }\r\n    // 用来标记 fiberNode 的插入、删除、移动\r\n    return function reconcilerChildFibers(returnFiber, currentFiber, newChild // 子节点的 reactElement\r\n    ) {\r\n        // 判断当前 fiber 的类型\r\n        if (typeof newChild === 'object' && newChild !== null) {\r\n            switch (newChild.$$typeof) {\r\n                case REACT_ELEMENT_TYPE:\r\n                    return placeSingChild(reconcilerSingleElement(returnFiber, currentFiber, newChild));\r\n                default:\r\n                    if (true) {\r\n                        console.warn('未实现的reconciler类型', newChild);\r\n                    }\r\n                    break;\r\n            }\r\n        }\r\n        // HostText\r\n        if (typeof newChild === 'string' || typeof newChild === 'number') {\r\n            return placeSingChild(reconcilerSingleTextNode(returnFiber, currentFiber, newChild));\r\n        }\r\n        if (true) {\r\n            console.warn('未实现的reconciler类型', newChild);\r\n        }\r\n        return null;\r\n    };\r\n}\r\n// update阶段 追踪副作用\r\nexport const reconcilerChildFibers = ChildReconciler(true);\r\nexport const mountChildFibers = ChildReconciler(false);\r\n//# sourceMappingURL=childFibers.js.map","references":["/Users/liangshuhao/Learn/coderwhy/Learn React/Big-React18-/big-react18/packages/react-reconciler/src/fiberFlags.ts","/Users/liangshuhao/Learn/coderwhy/Learn React/Big-React18-/big-react18/packages/react-reconciler/src/workTags.ts","/Users/liangshuhao/Learn/coderwhy/Learn React/Big-React18-/big-react18/packages/shared/ReactSymbols.ts","/Users/liangshuhao/Learn/coderwhy/Learn React/Big-React18-/big-react18/packages/shared/ReactTypes.ts","/Users/liangshuhao/Learn/coderwhy/Learn React/Big-React18-/big-react18/packages/react-reconciler/src/fiber.ts"],"map":"{\"version\":3,\"file\":\"childFibers.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../packages/react-reconciler/src/childFibers.ts\"],\"names\":[],\"mappings\":\"AAAA,OAAO,EAAE,SAAS,EAAE,MAAM,cAAc,CAAC;AACzC,OAAO,EAAE,QAAQ,EAAE,MAAM,YAAY,CAAC;AACtC,OAAO,EAAE,kBAAkB,EAAE,MAAM,6BAA6B,CAAC;AAEjE,OAAO,EAAE,SAAS,EAAE,sBAAsB,EAAE,MAAM,SAAS,CAAC;AAE5D;;;;GAIG;AACH,SAAS,eAAe,CAAC,kBAA2B;IACnD,kEAAkE;IAClE,SAAS,uBAAuB,CAC/B,WAAsB,EACtB,YAA8B,EAC9B,OAAyB;QAEzB,uBAAuB;QACvB,MAAM,KAAK,GAAG,sBAAsB,CAAC,OAAO,CAAC,CAAC;QAC9C,KAAK,CAAC,MAAM,GAAG,WAAW,CAAC;QAC3B,OAAO,KAAK,CAAC;IACd,CAAC;IAED,SAAS,wBAAwB,CAChC,WAAsB,EACtB,YAA8B,EAC9B,OAAwB;QAExB,MAAM,KAAK,GAAG,IAAI,SAAS,CAAC,QAAQ,EAAE,EAAE,OAAO,EAAE,EAAE,IAAI,CAAC,CAAC;QACzD,KAAK,CAAC,MAAM,GAAG,WAAW,CAAC;QAC3B,OAAO,KAAK,CAAC;IACd,CAAC;IAED,qBAAqB;IACrB,SAAS,cAAc,CAAC,KAAgB;QACvC,wDAAwD;QACxD,6CAA6C;QAC7C,IAAI,kBAAkB,IAAI,KAAK,CAAC,SAAS,KAAK,IAAI,EAAE;YACnD,kCAAkC;YAClC,QAAQ;YACR,KAAK,CAAC,KAAK,IAAI,SAAS,CAAC;SACzB;QACD,OAAO,KAAK,CAAC;IACd,CAAC;IAED,2BAA2B;IAC3B,OAAO,SAAS,qBAAqB,CACpC,WAAsB,EACtB,YAA8B,EAC9B,QAA2B,CAAC,oBAAoB;;QAEhD,iBAAiB;QACjB,IAAI,OAAO,QAAQ,KAAK,QAAQ,IAAI,QAAQ,KAAK,IAAI,EAAE;YACtD,QAAQ,QAAQ,CAAC,QAAQ,EAAE;gBAC1B,KAAK,kBAAkB;oBACtB,OAAO,cAAc,CACpB,uBAAuB,CAAC,WAAW,EAAE,YAAY,EAAE,QAAQ,CAAC,CAC5D,CAAC;gBACH;oBACC,IAAI,IAAI,EAAE;wBACT,OAAO,CAAC,IAAI,CAAC,kBAAkB,EAAE,QAAQ,CAAC,CAAC;qBAC3C;oBACD,MAAM;aACP;SACD;QAED,WAAW;QACX,IAAI,OAAO,QAAQ,KAAK,QAAQ,IAAI,OAAO,QAAQ,KAAK,QAAQ,EAAE;YACjE,OAAO,cAAc,CACpB,wBAAwB,CAAC,WAAW,EAAE,YAAY,EAAE,QAAQ,CAAC,CAC7D,CAAC;SACF;QAED,IAAI,IAAI,EAAE;YACT,OAAO,CAAC,IAAI,CAAC,kBAAkB,EAAE,QAAQ,CAAC,CAAC;SAC3C;QAED,OAAO,IAAI,CAAC;IACb,CAAC,CAAC;AACH,CAAC;AAED,iBAAiB;AACjB,MAAM,CAAC,MAAM,qBAAqB,GAAG,eAAe,CAAC,IAAI,CAAC,CAAC;AAC3D,MAAM,CAAC,MAAM,gBAAgB,GAAG,eAAe,CAAC,KAAK,CAAC,CAAC\"}"}
